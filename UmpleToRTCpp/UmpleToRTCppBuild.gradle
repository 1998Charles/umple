sourceSets {
    main { 
        umple{
           outputDir = file('../cruise.umple/GradleTest/src-gen-umpletl')
           master = file('UmpleTLTemplates/Master.ump')
           compileGenerated = false // turn this off if this project is ever decoupled from cruise.umple and can be compiled independently
           customMasterPath = true
        }
        //output.classesDir = "../cruise.umple/GradleTest/bin" // use to control where the .class files are outputted if this project is compiled independently
    }
}

// Incremental build logic
compileUmple {
    inputs.dir("UmpleTLTemplates") // If any of the source .ump files here have changed, recompile them. Otherwise the task is considered up-to-date
    //outputs.dir("../cruise.umple/GradleTest/src-gen-umpletl") //TODO Gradle views this as changed after every build. Need a better way to monitor outputs
}

// We only use the umple compiler jar to generate just a couple source files. The rest are precompiled. We must move them over to where we compile.  
task copyRTCppNonGenSource (type: Copy) {
    from('../cruise.umple.nebula/src') {
    }
    from('../UmpleToRTCpp/src') {
    }
    into '../cruise.umple/GradleTest/src-gen-umple'
}  

compileUmple.dependsOn('copyRTCppNonGenSource')
